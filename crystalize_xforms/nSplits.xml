<?xml version="1.0" encoding="utf-8"?>
<user_transforms>
	<transform_def name="nSplits">
		<!-- Original code by Edward Haas AKA EFHIII -->
		<node name="input_params">
			<real name="nSplits">1</real>
			<real name="nSplits_N">3</real>
			<real name="nSplits_Split">0</real>
			<real name="nSplits_Wedge">1</real>
		</node>

		<node name="internal_params">
			<real name="weight" />
			<real name="n" />
			<real name="regSize" />
			<real name="split" />
			<real name="wedge" />
		</node>

		<string name="winter_init_function">
			<![CDATA[
				nSplits_init_result(nSplits, nSplits_N, twopi() / nSplits_N, nSplits_Split, nSplits_Wedge)
			]]>
		</string>

		<string name="winter_eval_function">
			<![CDATA[
				let
					ns = -p_in
					rad = length(ns)
					theta = atan2(ns.y, ns.x) + pi()
					region = floor(theta / twopi() * n)
					mTheta = theta - regSize * region

					newTheta = region * regSize + regSize / 2 + (mTheta - regSize / 2) * wedge

					ang = (region + 0.5) / n * twopi()
					splitter = vec2(cos(ang),sin(ang)) * split
				in
					(vec2(cos(newTheta),sin(newTheta)) * rad + splitter) * weight
			]]>
		</string>
	</transform_def>


</user_transforms>
