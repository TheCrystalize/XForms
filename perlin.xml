<?xml version="1.0" encoding="utf-8"?>
<user_transforms>
	<transform_def name="perlin">
		<node name="input_params">
			<real name="perlin">1</real>
		</node>

		<node name="internal_params">
			<real name="weight" />
		</node>

		<int name="num_unit_randoms">5</int>

		<string name="winter_init_function">
			<![CDATA[
				perlin_init_result(perlin)
			]]>
		</string>

		<string name="winter_eval_function">
			<![CDATA[
				let
					x0 = truncateToInt(p_in.x)
					x1 = x0 + 1
					y0 = truncateToInt(p_in.y)
					y1 = y0 + 1

					sx = p_in.x - toReal(x0)
					sy = p_in.y - toReal(y0)

					n0 = dGGrad(x0, y0, p_in.x, p_in.y, unit_rnd_0)
					n1 = dGGrad(x1, y1, p_in.x, p_in.y, unit_rnd_1)
					ix0 = lerp(n0, n1, sx)

					m0 = dGGrad(x0, y0, p_in.x, p_in.y, unit_rnd_2)
					m1 = dGGrad(x1, y1, p_in.x, p_in.y, unit_rnd_3)
					ix1 = lerp(m0, m1, sx)

					r = weight * sqrt(abs(lerp(ix0, ix1, sy)))
					a = unit_rnd_4 * twopi()
				in
					vec2(cos(a), sin(a)) * r
			]]>
		</string>
	</transform_def>


</user_transforms>
